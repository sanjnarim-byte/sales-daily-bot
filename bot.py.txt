import asyncio
from datetime import datetime, time
from telegram import Bot
from telegram.ext import ApplicationBuilder

TOKEN = "8571351637:AAFVB-tOmNMD5I8lLDXo6imTYaMMlchk28k"
CHAT_ID = 5220191520
ZOOM_LINK = "https://zoom.us/your_meeting_link"

async def send_reminder():
    bot = Bot(token=TOKEN)
    text = (
        "‚è∞ –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ!\n\n"
        "–ß–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π —Å–æ–∑–≤–æ–Ω –≤ Zoom.\n\n"
        f"üëâ –°—Å—ã–ª–∫–∞: https://us05web.zoom.us/j/9139218826?pwd=tcgKFwYDFWxVj5bJXh3l4HaatgnhvK.1"
    )
    await bot.send_message(chat_id=5220191520, text=text)

async def scheduler():
    last_sent_date = None

    while True:
        now = datetime.now()
        weekday = now.weekday()  # 0=–ü–Ω, 1=–í—Ç, ... 4=–ü—Ç
        current_time = now.time()

        # –¢–æ–ª—å–∫–æ –±—É–¥–Ω–∏–µ –¥–Ω–∏
        if weekday < 5:
            # –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ = 10:55, –æ—Å—Ç–∞–ª—å–Ω—ã–µ = 09:55
            if weekday == 0:
                target_time = time(10, 55)
            else:
                target_time = time(9, 55)

            if (current_time.hour == target_time.hour and
                current_time.minute == target_time.minute):

                # –ß—Ç–æ–±—ã –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–ª –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤ –æ–¥–Ω—É –º–∏–Ω—É—Ç—É
                if last_sent_date != now.date():
                    await send_reminder()
                    last_sent_date = now.date()

        await asyncio.sleep(30)

async def main():
    app = ApplicationBuilder().token(TOKEN).build()
    asyncio.create_task(scheduler())
    await app.initialize()
    await app.start()
    await asyncio.Event().wait()

if __name__ == "__main__":
    asyncio.run(main())
